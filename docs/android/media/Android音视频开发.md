# Android音视频开发

[音视频开发基础知识](../base/音视频基础.md)

| 学习路径            |                          |
| ------------------- | ------------------------ |
| C/C++               | 编码基础                 |
| FFmpeg              | 音视频处理框架           |
| OpenGL ES           | 视频特效、美颜算法。     |
| libyuv              | YUV帧处理库              |
| libx264/libx265     | H.264/H.265软编码库      |
| ExoPlayer/ijkplayer | 开源视频播放器，深入学习 |
| ARM NEON 汇编       | 加速视频编解码、帧处理   |
|                     |                          |

## 视频录制

### MediaRecorder

直接使用系统提供的`MediaRecorder`录制整个视频。优点就是简单方便，缺点是定制化较差。适用于对视频要求不高的场景。

### Camera

可以获取到摄像头输出的原始数据，我们可以使用`FFmped`等库对数据进行处理后（裁剪、缩放等）再送入编码器。编码器可以选择系统的`MediaCodec`进行编码，若对画质有要求可使用x264 来进行编码。

## 视频处理

### 视频编辑

* 视频裁剪
* 视频拼接

MediaExtractor：Android系统提供，不过`seekTo`接口只能跳转到关键帧的位置，所以不一定能精准定位，此时需要结合解码器，将帧数据解码后并进行逻辑判断后再重新编码、合成。

### 视频播放

> 对于MP4的边下边播，需要将moov放到文件头部,MP4解码依赖了moov中的信息。可以使用`FFmpeg、mp4v2等工具。
>
> moov内记录了MP4的音轨视轨格式、视频长度、播放速率、视轨关键帧位置偏移量等信息。

* MediaPlayer：系统自带，比较适用于播放本地视频。支持在线播放，默认存储到私有位置，访问不方便，需要通过URL代理的方式处理，下载到指定位置。同样存在无法精准`seek`的问题。

* 基于MediaCodec开发播放器。

* ExoPlayer：Google开源播放器。

## OpenGL ES 环境搭建

* 使用 GLSurfaceView。
* 使用EGL API，在Native层基于C++进行搭建。

